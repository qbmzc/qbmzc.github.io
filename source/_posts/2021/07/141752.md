---
title: curl模拟请求
date: 2021-3-9
categories:
  - work
tags:
  - js
---


![20210506123850](https://fastly.jsdelivr.net/gh/qbmzc/images/md/20210506123850.png)

<!-- more -->

## curl GET

```bash
# curl+url
curl https://qbmzc.github.io -v
# -v 查看详细的请求信息

#参数
curl -X GET --header 'Accept: application/json' --header 'TM-Header-AppId: 1' --header 'TM-Header-TenantId: 1' --header 'TM-Header-UserId: 1' --header 'TM-Header-UserName: 1' 'http://10.101.102.139:11001/hls/trans/getByFileId/1'
```

## curl POST

```bash
# curl -X POST 
```

## curl POST 上传文件


```bash
-F "file=@file_path"
## demo
curl -X POST  http://127.0.0.1/api/demo/upimg -F "file=@/Users/fungleo/Downloads/401.png" -H "token: 222" -v
```
   
```shell
curl -X POST --header 'Content-Type: multipart/form-data' --header 'Accept: application/json' --header 'TM-Header-TenantId: 027028eb7553472c9d94a650001af23a' --header 'TM-Header-Locale: 027028eb7553472c9d94a650001af23a' --header 'TM-Header-Token: 027028eb7553472c9d94a650001af23a' --header 'TM-Header-Environment-Token: 027028eb7553472c9d94a650001af23a' --header 'TM-Header-AppId: 027028eb7553472c9d94a650001af23a' --header 'TM-Header-AccountName: 027028eb7553472c9d94a650001af23a' -F "file=@/taimei/index.html" {"type":"formData"} 'http://127.0.0.1:8080/file/upload?appId=hls' 
```

## 帮助

```bash
curl --help all
# 或者
man curl
```

## curl下载文件

以下是使用 `curl` 下载文件的常用方法和参数：

## 基本下载命令

### 1. 简单下载文件
```bash
# 下载文件并显示在终端
curl https://example.com/file.zip

# 下载文件并保存（使用原文件名）
curl -O https://example.com/file.zip

# 下载文件并指定保存文件名
curl -o custom-name.zip https://example.com/file.zip
```

### 2. 常用参数组合
```bash
# 显示进度条，断点续传，跟随重定向
curl -L -C - -O https://example.com/large-file.zip

# 静默下载（不显示进度信息）
curl -s -O https://example.com/file.zip

# 显示详细信息
curl -v -O https://example.com/file.zip
```

## 高级用法

### 3. 断点续传
```bash
# 如果下载中断，可以从中断处继续下载
curl -C - -O https://example.com/large-file.iso
```

### 4. 限制下载速度
```bash
# 限制下载速度为 100KB/s
curl --limit-rate 100K -O https://example.com/file.zip

# 限制为 1MB/s
curl --limit-rate 1M -O https://example.com/file.zip
```

### 5. 下载多个文件
```bash
# 同时下载多个文件
curl -O https://example.com/file1.zip -O https://example.com/file2.zip

# 使用循环下载序列文件
for i in {1..10}; do
    curl -O "https://example.com/file${i}.zip"
done
```

### 6. 处理认证和 Cookie
```bash
# 带用户名密码认证
curl -u username:password -O https://example.com/protected/file.zip

# 使用 Cookie
curl -b "session=abc123" -O https://example.com/file.zip

# 从文件读取 Cookie
curl -b cookies.txt -O https://example.com/file.zip
```

### 7. 处理重定向
```bash
# 自动跟随重定向（默认不跟随）
curl -L -O https://example.com/file.zip
```

### 8. 设置超时
```bash
# 设置连接超时和最大请求时间
curl --connect-timeout 30 --max-time 300 -O https://example.com/file.zip
```

## 实际应用示例

### 9. 下载 GitHub Release 文件
```bash
# 下载 GitHub release 文件（需要跟随重定向）
curl -L -O https://github.com/user/repo/releases/download/v1.0/app.tar.gz
```

### 10. 下载并直接解压
```bash
# 下载 tar.gz 并直接解压
curl -L https://example.com/file.tar.gz | tar xz

# 下载 zip 文件并直接解压（需要 unzip）
curl -L https://example.com/file.zip -o temp.zip && unzip temp.zip && rm temp.zip
```

### 11. 下载到特定目录
```bash
# 下载到指定目录
curl -o /path/to/directory/file.zip https://example.com/file.zip

# 或者先进入目录再下载
cd /path/to/directory && curl -O https://example.com/file.zip
```

### 12. 检查文件是否存在后再下载
```bash
# 只检查 HEAD 信息
curl -I https://example.com/file.zip

# 如果文件存在则下载
curl -f -O https://example.com/file.zip
```

### 13. 使用代理下载
```bash
# 使用 HTTP 代理
curl -x http://proxy-server:port -O https://example.com/file.zip

# 使用 SOCKS 代理
curl --socks5 proxy-server:port -O https://example.com/file.zip
```

## 常用参数总结

| 参数 | 说明 |
|------|------|
| `-O` | 使用服务器上的文件名保存 |
| `-o <file>` | 指定保存的文件名 |
| `-L` | 跟随重定向 |
| `-C -` | 断点续传 |
| `--limit-rate <speed>` | 限制下载速度 |
| `-s` | 静默模式（不显示进度） |
| `-v` | 显示详细信息 |
| `-u user:pass` | 用户名密码认证 |
| `-b cookie` | 使用 Cookie |
| `-x proxy:port` | 使用代理 |

## 实用技巧

### 批量下载脚本
```bash
#!/bin/bash
URLS=(
    "https://example.com/file1.zip"
    "https://example.com/file2.zip"
    "https://example.com/file3.zip"
)

for url in "${URLS[@]}"; do
    echo "Downloading: $url"
    curl -L -O "$url"
done
```

### 监控下载进度
```bash
# 使用进度条显示
curl -# -O https://example.com/large-file.iso
```
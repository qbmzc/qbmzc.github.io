---
title: uvåŒ…ç®¡ç†å™¨
date: 2025-03-28 14:06:09
tags:
  - pip
  - anaconda
  - python
categories:
  - Python
toc: true
---

`uv` æ˜¯ Astral å…¬å¸å¼€å‘çš„ä¸€æ¬¾é©å‘½æ€§çš„ Python åŒ…ç®¡ç†å·¥å…·ï¼Œè¢«èª‰ä¸º Python åŒ…ç®¡ç†çš„æœªæ¥ã€‚å®ƒä»¥å…¶æè‡´çš„æ€§èƒ½å’Œç°ä»£åŒ–çš„è®¾è®¡ç†å¿µï¼Œæ­£åœ¨æ”¹å˜ Python å¼€å‘è€…çš„å·¥ä½œæµç¨‹ã€‚

<!-- more -->

## ä»€ä¹ˆæ˜¯ uvï¼Ÿ

`uv` æ˜¯ Astral å…¬å¸å¼€å‘çš„ä¸€æ¬¾é«˜æ€§èƒ½çš„ Python åŒ…ç®¡ç†å·¥å…·ï¼Œå¯¹æ ‡ Rust çš„ Cargo åŒ…ç®¡ç†å™¨ã€‚å®ƒæ—¨åœ¨æ›¿ä»£ä¼ ç»Ÿçš„ `pip`ã€`pip-tools` å’Œ `virtualenv`ï¼Œæä¾›æ›´å¿«çš„ä¾èµ–è§£æå’Œå®‰è£…é€Ÿåº¦ï¼ŒåŒæ—¶æ”¯æŒè™šæ‹Ÿç¯å¢ƒç®¡ç†ã€ä¾èµ–é”å®šç­‰ç°ä»£åŒ–åŠŸèƒ½ã€‚

### ä¸ºä»€ä¹ˆé€‰æ‹© uvï¼Ÿ

- **ğŸš€ æé€Ÿæ€§èƒ½**ï¼šæ¯” pip å¿« 10-100 å€
- **ğŸ”’ ç¡®å®šæ€§æ„å»º**ï¼šç¡®ä¿å¯é‡ç°çš„ä¾èµ–ç¯å¢ƒ
- **ğŸ› ï¸ ç»Ÿä¸€å·¥å…·é“¾**ï¼šä¸€ä¸ªå·¥å…·è§£å†³æ‰€æœ‰åŒ…ç®¡ç†éœ€æ±‚
- **ğŸŒ è·¨å¹³å°æ”¯æŒ**ï¼šWindowsã€Linuxã€macOS å®Œç¾æ”¯æŒ
- **ğŸ“¦ ç°ä»£åŒ–è®¾è®¡**ï¼šå€Ÿé‰´ Rust Cargo çš„ä¼˜ç§€è®¾è®¡ç†å¿µ

## å®‰è£… uv

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨å®˜æ–¹å®‰è£…è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# macOS & Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows (PowerShell)
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
```

### æ–¹æ³•äºŒï¼šä½¿ç”¨ pip å®‰è£…

```bash
# éœ€è¦ Python 3.8+
pip install uv
```

### æ–¹æ³•ä¸‰ï¼šä½¿ç”¨åŒ…ç®¡ç†å™¨

```bash
# macOS (Homebrew)
brew install uv

# Arch Linux
pacman -S uv

# Ubuntu/Debian (éœ€è¦æ·»åŠ ä»“åº“)
curl -LsSf https://astral.sh/uv/install.sh | sh
```

### éªŒè¯å®‰è£…

```bash
uv --version
# è¾“å‡ºç±»ä¼¼ï¼šuv 0.1.0
```

## æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

### 1. åŒ…å®‰è£…ä¸ç®¡ç†

#### åŸºæœ¬å®‰è£…å‘½ä»¤

```bash
# å®‰è£…å•ä¸ªåŒ…
uv pip install requests

# å®‰è£…æŒ‡å®šç‰ˆæœ¬
uv pip install "requests>=2.25.0,<3.0"

# å®‰è£…å¤šä¸ªåŒ…
uv pip install requests numpy pandas

# ä» requirements.txt å®‰è£…
uv pip install -r requirements.txt

# å®‰è£…å½“å‰é¡¹ç›®ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
uv pip install -e .
```

#### é«˜çº§å®‰è£…é€‰é¡¹

```bash
# åªå®‰è£…ï¼Œä¸æ›´æ–°å·²å­˜åœ¨çš„åŒ…
uv pip install --no-upgrade requests

# å¼ºåˆ¶é‡æ–°å®‰è£…
uv pip install --force-reinstall requests

# å®‰è£…åˆ°æŒ‡å®šç›®å½•
uv pip install --target ./packages requests

# å®‰è£…æ—¶å¿½ç•¥ä¾èµ–
uv pip install --no-deps requests
```

### 2. è™šæ‹Ÿç¯å¢ƒç®¡ç†

#### åˆ›å»ºå’Œç®¡ç†è™šæ‹Ÿç¯å¢ƒ

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒï¼ˆä½¿ç”¨é»˜è®¤ Python ç‰ˆæœ¬ï¼‰
uv venv

# åˆ›å»ºæŒ‡å®š Python ç‰ˆæœ¬çš„è™šæ‹Ÿç¯å¢ƒ
uv venv --python 3.11
uv venv --python 3.12

# åˆ›å»ºæŒ‡å®šåç§°çš„è™šæ‹Ÿç¯å¢ƒ
uv venv myenv

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶æŒ‡å®šè·¯å¾„
uv venv /path/to/venv
```

#### æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ

```bash
# Linux/macOS
source venv/bin/activate

# Windows (Command Prompt)
venv\Scripts\activate

# Windows (PowerShell)
venv\Scripts\Activate.ps1
```

#### è™šæ‹Ÿç¯å¢ƒç®¡ç†å‘½ä»¤

```bash
# åˆ—å‡ºæ‰€æœ‰è™šæ‹Ÿç¯å¢ƒ
uv venv list

# åˆ é™¤è™šæ‹Ÿç¯å¢ƒ
uv venv remove myenv

# åœ¨è™šæ‹Ÿç¯å¢ƒä¸­è¿è¡Œå‘½ä»¤
uv run python script.py
```

### 3. ä¾èµ–é”å®šä¸ç¼–è¯‘

#### ç”Ÿæˆä¾èµ–é”å®šæ–‡ä»¶

```bash
# ä» pyproject.toml ç”Ÿæˆ requirements.txt
uv pip compile pyproject.toml -o requirements.txt

# ç”Ÿæˆå¼€å‘ç¯å¢ƒä¾èµ–
uv pip compile pyproject.toml -o requirements-dev.txt --extra dev

# ç”Ÿæˆç”Ÿäº§ç¯å¢ƒä¾èµ–
uv pip compile pyproject.toml -o requirements-prod.txt --extra prod

# ç”Ÿæˆæ‰€æœ‰ä¾èµ–ï¼ˆåŒ…æ‹¬å¯é€‰ä¾èµ–ï¼‰
uv pip compile pyproject.toml --all-extras -o requirements-all.txt
```

#### åŒæ­¥ä¾èµ–

```bash
# åŒæ­¥åˆ°é”å®šæ–‡ä»¶çŠ¶æ€
uv pip sync requirements.txt

# ä»æ ‡å‡†è¾“å…¥åŒæ­¥
uv pip sync -

# åŒæ­¥å¹¶æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
uv pip sync --verbose requirements.txt
```

### 4. é¡¹ç›®åˆå§‹åŒ–ä¸ç®¡ç†

#### åˆ›å»ºæ–°é¡¹ç›®

```bash
# åˆå§‹åŒ–æ–°é¡¹ç›®
uv init my-project
cd my-project

# æ·»åŠ ä¾èµ–åˆ°é¡¹ç›®
uv add requests
uv add "numpy>=1.20.0"

# æ·»åŠ å¼€å‘ä¾èµ–
uv add --dev pytest
uv add --dev black flake8

# ç§»é™¤ä¾èµ–
uv remove requests
```

#### é¡¹ç›®ä¾èµ–ç®¡ç†

```bash
# æŸ¥çœ‹å·²å®‰è£…çš„åŒ…
uv pip list

# æŸ¥çœ‹è¿‡æ—¶çš„åŒ…
uv pip list --outdated

# æ›´æ–°æ‰€æœ‰åŒ…
uv pip install --upgrade

# æ›´æ–°ç‰¹å®šåŒ…
uv pip install --upgrade requests
```
    
## æ€§èƒ½å¯¹æ¯”ä¸ä¼˜åŠ¿

### é€Ÿåº¦å¯¹æ¯”

æ ¹æ®å®˜æ–¹åŸºå‡†æµ‹è¯•ï¼Œ`uv` åœ¨å„ä¸ªæ–¹é¢éƒ½æ˜¾è‘—ä¼˜äºä¼ ç»Ÿå·¥å…·ï¼š

| æ“ä½œ | pip | uv | æå‡å€æ•° |
|------|-----|----|---------| 
| ä¾èµ–è§£æ | 2.8s | 0.1s | **28x** |
| åŒ…å®‰è£… | 45s | 0.5s | **90x** |
| è™šæ‹Ÿç¯å¢ƒåˆ›å»º | 3.2s | 0.1s | **32x** |

### æ ¸å¿ƒä¼˜åŠ¿

- **ğŸš€ æé€Ÿæ€§èƒ½**ï¼šæ¯” pip å¿« 10-100 å€ï¼Œå¤§å¹…æå‡å¼€å‘æ•ˆç‡
- **ğŸ”’ ç¡®å®šæ€§æ„å»º**ï¼šé€šè¿‡é”å®šæ–‡ä»¶ç¡®ä¿å®Œå…¨å¯é‡ç°çš„æ„å»ºç¯å¢ƒ
- **ğŸ› ï¸ ç»Ÿä¸€å·¥å…·é“¾**ï¼šä¸€ä¸ªå·¥å…·æ›¿ä»£ pipã€virtualenvã€pip-tools
- **ğŸŒ è·¨å¹³å°æ”¯æŒ**ï¼šWindowsã€Linuxã€macOS å®Œç¾æ”¯æŒ
- **ğŸ“¦ ç°ä»£åŒ–è®¾è®¡**ï¼šå€Ÿé‰´ Rust Cargo çš„ä¼˜ç§€è®¾è®¡ç†å¿µ
- **ğŸ’¾ æ™ºèƒ½ç¼“å­˜**ï¼šé¿å…é‡å¤ä¸‹è½½å’Œç¼–è¯‘
- **ğŸ” æ›´å¥½çš„é”™è¯¯ä¿¡æ¯**ï¼šæ¸…æ™°çš„é”™è¯¯æç¤ºå’Œè§£å†³å»ºè®®

## å®é™…ä½¿ç”¨åœºæ™¯

### åœºæ™¯ä¸€ï¼šæ–°é¡¹ç›®å¼€å‘

```bash
# 1. åˆ›å»ºæ–°é¡¹ç›®
uv init my-awesome-project
cd my-awesome-project

# 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
uv venv

# 3. æ¿€æ´»ç¯å¢ƒå¹¶æ·»åŠ ä¾èµ–
source venv/bin/activate  # Linux/macOS
uv add requests fastapi uvicorn

# 4. æ·»åŠ å¼€å‘ä¾èµ–
uv add --dev pytest black mypy

# 5. å¼€å§‹å¼€å‘
uv run python main.py
```

### åœºæ™¯äºŒï¼šç°æœ‰é¡¹ç›®è¿ç§»

```bash
# 1. ä»ç°æœ‰ requirements.txt åˆ›å»ºé”å®šæ–‡ä»¶
uv pip compile requirements.txt -o requirements-lock.txt

# 2. åŒæ­¥åˆ°æ–°ç¯å¢ƒ
uv venv
source venv/bin/activate
uv pip sync requirements-lock.txt

# 3. éªŒè¯ç¯å¢ƒä¸€è‡´æ€§
uv pip list
```

### åœºæ™¯ä¸‰ï¼šCI/CD ç¯å¢ƒ

```bash
# åœ¨ CI ä¸­ä½¿ç”¨ uv è¿›è¡Œå¿«é€Ÿæ„å»º
- name: Install dependencies
  run: |
    uv venv
    source venv/bin/activate
    uv pip sync requirements.txt

- name: Run tests
  run: |
    source venv/bin/activate
    uv run pytest
```

## å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

### åŸºç¡€å‘½ä»¤

```bash
# æŸ¥çœ‹å¸®åŠ©
uv --help
uv pip --help

# æŸ¥çœ‹ç‰ˆæœ¬
uv --version

# æ¸…ç†ç¼“å­˜
uv clean

# æŸ¥çœ‹é…ç½®
uv config list
```

### é¡¹ç›®å‘½ä»¤

```bash
# åˆå§‹åŒ–é¡¹ç›®
uv init [project-name]

# æ·»åŠ ä¾èµ–
uv add package-name
uv add "package>=1.0.0,<2.0.0"

# ç§»é™¤ä¾èµ–
uv remove package-name

# æ›´æ–°ä¾èµ–
uv pip install --upgrade package-name
```

### ç¯å¢ƒå‘½ä»¤

```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
uv venv [env-name]

# åˆ—å‡ºè™šæ‹Ÿç¯å¢ƒ
uv venv list

# åˆ é™¤è™šæ‹Ÿç¯å¢ƒ
uv venv remove env-name

# åœ¨ç¯å¢ƒä¸­è¿è¡Œå‘½ä»¤
uv run python script.py
```

## æœ€ä½³å®è·µ

### 1. é¡¹ç›®ç»“æ„å»ºè®®

```
my-project/
â”œâ”€â”€ pyproject.toml          # é¡¹ç›®é…ç½®å’Œä¾èµ–å£°æ˜
â”œâ”€â”€ requirements.txt        # ç”Ÿäº§ç¯å¢ƒä¾èµ–
â”œâ”€â”€ requirements-dev.txt    # å¼€å‘ç¯å¢ƒä¾èµ–
â”œâ”€â”€ .python-version        # æŒ‡å®š Python ç‰ˆæœ¬
â””â”€â”€ .venv/                 # è™šæ‹Ÿç¯å¢ƒç›®å½•
```

### 2. ä¾èµ–ç®¡ç†ç­–ç•¥

```toml
# pyproject.toml ç¤ºä¾‹
[project]
name = "my-project"
version = "0.1.0"
dependencies = [
    "requests>=2.25.0",
    "numpy>=1.20.0",
]

[project.optional-dependencies]
dev = [
    "pytest>=6.0",
    "black>=21.0",
    "mypy>=0.900",
]
test = [
    "pytest-cov>=2.10",
    "pytest-mock>=3.5",
]
```

### 3. å›¢é˜Ÿåä½œå»ºè®®

- ä½¿ç”¨ `uv pip compile` ç”Ÿæˆé”å®šæ–‡ä»¶
- å°†é”å®šæ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
- åœ¨ CI/CD ä¸­ä½¿ç”¨ `uv pip sync` ç¡®ä¿ç¯å¢ƒä¸€è‡´æ€§
- å®šæœŸæ›´æ–°ä¾èµ–å¹¶æµ‹è¯•å…¼å®¹æ€§

## å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### Q1: å¦‚ä½•ä» pip è¿ç§»åˆ° uvï¼Ÿ

**A:** å¯ä»¥é€æ­¥è¿ç§»ï¼Œæ— éœ€ä¸€æ¬¡æ€§æ›¿æ¢ï¼š

```bash
# 1. ä¿æŒç°æœ‰ pip ç¯å¢ƒ
pip freeze > requirements.txt

# 2. ä½¿ç”¨ uv åˆ›å»ºæ–°ç¯å¢ƒ
uv venv new-env
source new-env/bin/activate

# 3. ä½¿ç”¨ uv å®‰è£…ä¾èµ–
uv pip install -r requirements.txt

# 4. éªŒè¯ç¯å¢ƒä¸€è‡´æ€§
uv pip list
```

### Q2: uv ä¸ Poetry/PDM æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

| ç‰¹æ€§ | uv | Poetry | PDM |
|------|----|---------|-----|
| é€Ÿåº¦ | æå¿« | ä¸­ç­‰ | å¿« |
| åŠŸèƒ½èŒƒå›´ | åŒ…ç®¡ç† | å…¨æ ˆé¡¹ç›®ç®¡ç† | åŒ…ç®¡ç†+å‘å¸ƒ |
| å­¦ä¹ æ›²çº¿ | ç®€å• | ä¸­ç­‰ | ç®€å• |
| ç”Ÿæ€æˆç†Ÿåº¦ | æ–° | æˆç†Ÿ | ä¸­ç­‰ |

### Q3: å¦‚ä½•å¤„ç†ç§æœ‰åŒ…ä»“åº“ï¼Ÿ

```bash
# é…ç½®ç§æœ‰ä»“åº“
uv pip install --index-url https://pypi.company.com/simple/ package-name

# æˆ–ä½¿ç”¨é…ç½®æ–‡ä»¶
# ~/.pip/pip.conf
[global]
index-url = https://pypi.company.com/simple/
trusted-host = pypi.company.com
```

### Q4: å¦‚ä½•è§£å†³ä¾èµ–å†²çªï¼Ÿ

```bash
# æŸ¥çœ‹ä¾èµ–æ ‘
uv pip show --tree package-name

# å¼ºåˆ¶é‡æ–°è§£æ
uv pip install --force-reinstall package-name

# ä½¿ç”¨çº¦æŸæ–‡ä»¶
uv pip install -c constraints.txt package-name
```

## æ€»ç»“

`uv` ä½œä¸ºæ–°ä¸€ä»£ Python åŒ…ç®¡ç†å·¥å…·ï¼Œä»¥å…¶å“è¶Šçš„æ€§èƒ½å’Œç°ä»£åŒ–çš„è®¾è®¡ç†å¿µï¼Œæ­£åœ¨æˆä¸º Python å¼€å‘è€…çš„é¦–é€‰ã€‚æ— è®ºæ˜¯æ–°é¡¹ç›®å¼€å‘è¿˜æ˜¯ç°æœ‰é¡¹ç›®è¿ç§»ï¼Œ`uv` éƒ½èƒ½æ˜¾è‘—æå‡å¼€å‘æ•ˆç‡å’Œæ„å»ºé€Ÿåº¦ã€‚

**æ¨èä½¿ç”¨åœºæ™¯ï¼š**
- æ–°é¡¹ç›®å¼€å‘
- éœ€è¦å¿«é€Ÿæ„å»ºçš„ CI/CD ç¯å¢ƒ
- å¤§å‹é¡¹ç›®çš„ä¾èµ–ç®¡ç†
- å›¢é˜Ÿåä½œå¼€å‘

**å¼€å§‹ä½¿ç”¨ uvï¼Œä½“éªŒ Python åŒ…ç®¡ç†çš„æœªæ¥ï¼** ğŸš€

---

*æ›´å¤šè¯¦ç»†ä¿¡æ¯è¯·å‚è€ƒ [uv å®˜æ–¹æ–‡æ¡£](https://docs.astral.sh/uv/) æˆ–è¿è¡Œ `uv --help` æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ã€‚*

